<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Futurefolio â€“ Live Stocks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100 p-6 font-sans">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;
    const API_KEY = 'T4QNXPY9XE3NOAI3'; // ðŸ”‘ your API key

    function App() {
      const symbols = ['AAPL','TSLA','AMZN','GOOG'];
      const [stockData, setStockData] = useState([]);
      const [tab, setTab] = useState("portfolio");
      const [expanded, setExpanded] = useState(null);
      const chartRef = useRef();
      const chartInstance = useRef();

      // Fetch live stock quotes
      const fetchStocks = () => {
        Promise.all(symbols.map(sym =>
          fetch(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${sym}&apikey=${API_KEY}`)
            .then(r => r.json())
            .then(js => ({
              ticker: sym,
              price: js['Global Quote']['05. price'],
              change: parseFloat(js['Global Quote']['10. change percent'])
            }))
        ))
        .then(data => setStockData(data))
        .catch(e => console.error('Error loading stock data', e));
      };

      useEffect(() => {
        fetchStocks();
        const iv = setInterval(fetchStocks, 60000); // refresh every 60s
        return () => clearInterval(iv);
      }, []);

      return (
        <div className="max-w-4xl mx-auto space-y-6">
          <div className="space-x-4">
            <button onClick={() => setTab("portfolio")} 
              className={`px-4 py-2 rounded ${tab==="portfolio" ? "bg-blue-500 text-white":"bg-gray-300"}`}>
              My Portfolio
            </button>
            <button onClick={() => setTab("news")} 
              className={`px-4 py-2 rounded ${tab==="news" ? "bg-blue-500 text-white":"bg-gray-300"}`}>
              Daily News
            </button>
          </div>

          {tab === "portfolio" && (
            <>
              <canvas ref={chartRef} width="300" height="300"/>
              <ul>
                {stockData.map(s => (
                  <li key={s.ticker}>
                    <div className="cursor-pointer" onClick={()=>setExpanded(expanded===s.ticker?null:s.ticker)}>
                      {s.ticker}: ${parseFloat(s.price).toFixed(2)} ({s.change?.toFixed(2)}%)
                    </div>
                    {expanded===s.ticker && <div>Detailed info...</div>}
                  </li>
                ))}
              </ul>
            </>
          )}
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById("root"));
  </script>
</body>
</html>
